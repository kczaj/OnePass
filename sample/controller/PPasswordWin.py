#######################################################
# 
# PPasswordWin.py
# Python implementation of the Class PPasswordWin
# Generated by Enterprise Architect
# Created on:      04-kwi-2020 12:09:39
# Original author: KUBA
# 
#######################################################
from sample.controller.PController import PController
from PyQt5 import QtWidgets
import pyperclip

from sample.view.VAddPasswordWin import VAddPasswordWin


class PPasswordWin(PController):

    def __init__(self, main_window, password_list_window, password_win):
        super().__init__(main_window, password_list_window)
        self._edit_win = VAddPasswordWin(self.main_window, password_win)
        self._password = None
        self._is_password_in_password_mode = True

    def save_button_handle(self, login_frame, password_frame, star_button):
        login = login_frame.text()
        password = password_frame.text()
        is_favourite = star_button.isChecked()
        self._password.update((login, password, is_favourite))

    def copy_button_handel(self, password_frame):
        text = password_frame.text()
        pyperclip.copy(text)

    def show_button_handle(self, password_frame):
        if self._is_password_in_password_mode:
            password_frame.setEchoMode(QtWidgets.QLineEdit.Normal)
            self._is_password_in_password_mode = False
        else:
            password_frame.setEchoMode(QtWidgets.QLineEdit.Password)
            self._is_password_in_password_mode = True

    def set_password_data(self, name_label, login_frame, password_frame, star_button, password=None):
        if password != None:
            self._password = password
        name_instance = self._password.get_name()
        login_instance = self._password.get_login()
        password_instance = self._password.get_password()
        isFavourite = self._password.get_is_favourite()
        name_label.setText(name_instance.upper())
        login_frame.setText(login_instance)
        password_frame.setText(password_instance)
        if isFavourite:
            star_button.setChecked(True)
        else:
            star_button.setChecked(False)
